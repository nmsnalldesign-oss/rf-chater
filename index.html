<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RF Chater - Test Client</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #1a1a2e; color: #eee; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: #16213e; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .header h1 { color: #0f3460; margin-bottom: 10px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .panel { background: #16213e; border-radius: 8px; padding: 20px; border-left: 4px solid #0f3460; }
        .panel h2 { margin-bottom: 15px; color: #00d4ff; }
        input, textarea, button { background: #0f3460; color: #eee; border: 1px solid #0f3460; padding: 10px; border-radius: 4px; margin-bottom: 10px; width: 100%; }
        button { cursor: pointer; background: #00d4ff; color: #16213e; font-weight: bold; }
        button:hover { background: #0099cc; }
        #messages { background: #0f3460; border-radius: 4px; padding: 10px; height: 300px; overflow-y: auto; margin-bottom: 10px; }
        .message { background: #16213e; padding: 8px; margin: 5px 0; border-left: 3px solid #00d4ff; border-radius: 4px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; text-align: center; }
        .status.connected { background: #2ecc71; color: #fff; }
        .status.disconnected { background: #e74c3c; color: #fff; }
        #users { background: #0f3460; border-radius: 4px; padding: 10px; max-height: 200px; overflow-y: auto; }
        .user-item { background: #16213e; padding: 8px; margin: 5px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>RF Chater - Test Client</h1>
            <p>Desktop Chat & Voice App Server - Connection Test</p>
            <div id="status" class="status disconnected">âšª Disconnected</div>
        </div>
        
        <div class="grid">
            <div class="panel">
                <h2>Register & Connect</h2>
                <input type="text" id="nameInput" placeholder="Enter your name" value="User1">
                <button onclick="register()">Connect as User</button>
                <button onclick="disconnect()">Disconnect</button>
                
                <h2 style="margin-top: 20px;">Online Users</h2>
                <div id="users">No users connected</div>
            </div>
            
            <div class="panel">
                <h2>Messages</h2>
                <div id="messages"></div>
                <input type="text" id="messageInput" placeholder="Type a message...">
                <button onclick="sendMessage()">Send Message</button>
            </div>
        </div>
    </div>
    
    <script>
        const socket = io();
        
        socket.on('connect', () => {
            console.log('Connected to server');
            updateStatus(true);
            addMessage('System', 'Connected to server!');
        });
        
        socket.on('disconnect', () => {
            console.log('Disconnected from server');
            updateStatus(false);
            addMessage('System', 'Disconnected from server!');
        });
        
        socket.on('users-list', (users) => {
            const usersList = document.getElementById('users');
            if (users.length === 0) {
                usersList.innerHTML = 'No users connected';
            } else {
                usersList.innerHTML = users.map(u => `<div class="user-item">ðŸ‘¤ ${u.name} (${u.status})</div>`).join('');
            }
        });
        
        socket.on('message', (msg) => {
            addMessage(msg.sender, msg.text);
        });
        
        function register() {
            const name = document.getElementById('nameInput').value.trim();
            if (!name) { alert('Please enter a name'); return; }
            socket.emit('register', name);
            addMessage('System', `You connected as ${name}`);
        }
        
        function sendMessage() {
            const msgInput = document.getElementById('messageInput');
            const text = msgInput.value.trim();
            if (!text) return;
            socket.emit('message', { text, timestamp: new Date() });
            msgInput.value = '';
        }
        
        function addMessage(sender, text) {
            const messagesDiv = document.getElementById('messages');
            const messageEl = document.createElement('div');
            messageEl.className = 'message';
            messageEl.textContent = `${sender}: ${text}`;
            messagesDiv.appendChild(messageEl);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        function updateStatus(connected) {
            const statusEl = document.getElementById('status');
            if (connected) {
                statusEl.textContent = 'ðŸŸ¢ Connected';
                statusEl.className = 'status connected';
            } else {
                statusEl.textContent = 'ðŸ”´ Disconnected';
                statusEl.className = 'status disconnected';
            }
        }
        
        function disconnect() {
            socket.disconnect();
        }
        
        document.getElementById('messageInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html>
